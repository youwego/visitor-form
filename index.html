<script>
  document.getElementById("form").addEventListener("submit", function(e) {
    e.preventDefault();

    const artist = document.getElementById("artist").value.trim();
    const presale = document.getElementById("presale").value.trim();
    const guest = document.getElementById("guest").value.trim();
    const memo = document.getElementById("memo").value.trim();

    if (!artist || !presale || !guest) {
      alert("すべての必須項目を入力してください。");
      return;
    }

    const data = { artist, presale, guest, memo };

    fetch("https://script.google.com/macros/s/AKfycbzeOd9bQnNyah1eukOkbJOuagTVX6SSxL6ciWdD4jr6n2KHpPU0LneZJa6Vsgeu-xgt/exec", {
      method: "POST",
      mode: "no-cors", // ← これが超重要
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify(data)
    })
    .then(() => {
      // no-cors なのでレスポンスは読めない → 成功前提でthanksへ
      window.location.href = "thanks.html";
    })
    .catch(err => {
      alert("通信エラー: " + err.message);
    });
  });
</script>
